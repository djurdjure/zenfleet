<div class="max-w-5xl mx-auto"> <form wire:submit.prevent="save" class="space-y-6"> {{-- En-tête --}} <div class="flex items-center justify-between"> <h1 class="text-2xl font-bold text-gray-900"> {{ $isEditMode ? 'Modifier la dépense' : 'Nouvelle dépense' }} </h1> <div class="flex items-center gap-3"> <button type="button" wire:click="cancel" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition"> Annuler </button> <button type="submit" class="px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition"> {{ $isEditMode ? 'Mettre à jour' : 'Créer' }} </button> </div> </div> {{-- Informations générales --}} <x-card> <div class="p-6 space-y-6"> <h3 class="text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2"> Informations générales </h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-6"> <div> <x-input-label for="expense_number" value="N° Dépense *" /> <x-input id="expense_number" wire:model="expense_number" :disabled="$isEditMode" class="w-full" required /> @error('expense_number') <span class="text-sm text-red-500">{{ $message }}</span> @enderror </div> <div> <x-input-label for="expense_date" value="Date de dépense *" /> <x-input id="expense_date" type="date" wire:model="expense_date" class="w-full" required /> @error('expense_date') <span class="text-sm text-red-500">{{ $message }}</span> @enderror </div> <div> <x-input-label for="priority_level" value="Priorité" /> <x-select id="priority_level" wire:model="priority_level" class="w-full"> <option value="low">Faible</option> <option value="normal">Normale</option> <option value="high">Élevée</option> <option value="urgent">Urgente</option> </x-select> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="vehicle_id" value="Véhicule *" /> <x-select id="vehicle_id" wire:model.live="vehicle_id" class="w-full" required> <option value="">Sélectionner un véhicule</option> @foreach($vehicles as $vehicle) <option value="{{ $vehicle->id }}"> {{ $vehicle->license_plate }} - {{ $vehicle->brand }} {{ $vehicle->model }} </option> @endforeach </x-select> @error('vehicle_id') <span class="text-sm text-red-500">{{ $message }}</span> @enderror </div> <div> <x-input-label for="driver_id" value="Chauffeur" /> <x-select id="driver_id" wire:model="driver_id" class="w-full"> <option value="">Sélectionner un chauffeur</option> @foreach($drivers as $driver) <option value="{{ $driver->id }}"> {{ $driver->last_name }} {{ $driver->first_name }} </option> @endforeach </x-select> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="category" value="Catégorie *" /> <x-select id="category" wire:model.live="category" class="w-full" required> <option value="">Sélectionner une catégorie</option> @foreach(\App\Models\VehicleExpense::EXPENSE_CATEGORIES as $key => $label) <option value="{{ $key }}">{{ $label }}</option> @endforeach </x-select> @error('category') <span class="text-sm text-red-500">{{ $message }}</span> @enderror </div> <div> <x-input-label for="sub_category" value="Sous-catégorie" /> @if(count($subcategories) > 0) <x-select id="sub_category" wire:model="sub_category" class="w-full"> <option value="">Sélectionner une sous-catégorie</option> @foreach($subcategories as $subcat) <option value="{{ $subcat }}">{{ $subcat }}</option> @endforeach </x-select> @else <x-input id="sub_category" wire:model="sub_category" placeholder="Entrer une sous-catégorie" class="w-full" /> @endif </div> </div> <div> <x-input-label for="description" value="Description *" /> <x-textarea id="description" wire:model="description" class="w-full" rows="3" required /> @error('description') <span class="text-sm text-red-500">{{ $message }}</span> @enderror </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="odometer_reading" value="Kilométrage actuel" /> <x-input id="odometer_reading" type="number" wire:model="odometer_reading" class="w-full" min="0" /> </div> <div> <x-input-label for="location" value="Lieu" /> <x-input id="location" wire:model="location" placeholder="Ex: Alger, Station Shell..." class="w-full" /> </div> </div> </div> </x-card> {{-- Informations financières --}} <x-card> <div class="p-6 space-y-6"> <h3 class="text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2"> Informations financières </h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-6"> <div> <x-input-label for="quantity" value="Quantité" /> <x-input id="quantity" type="number" wire:model.live="quantity" class="w-full" min="0.01" step="0.01" /> </div> <div> <x-input-label for="unit_price" value="Prix unitaire" /> <x-input id="unit_price" type="number" wire:model.live="unit_price" class="w-full" min="0" step="0.01" /> </div> <div> <x-input-label for="amount" value="Montant HT *" /> <x-input id="amount" type="number" wire:model.live="amount" class="w-full" min="0" step="0.01" required /> @error('amount') <span class="text-sm text-red-500">{{ $message }}</span> @enderror </div> </div> <div class="grid grid-cols-1 md:grid-cols-4 gap-6"> <div> <x-input-label for="tax_rate" value="Taux TVA (%)" /> <x-input id="tax_rate" type="number" wire:model.live="tax_rate" class="w-full" min="0" max="100" step="0.01" /> </div> <div> <x-input-label for="tax_amount" value="Montant TVA" /> <x-input id="tax_amount" type="number" wire:model="tax_amount" class="w-full bg-gray-50" readonly /> </div> <div> <x-input-label for="discount_amount" value="Remise" /> <x-input id="discount_amount" type="number" wire:model.live="discount_amount" class="w-full" min="0" step="0.01" /> </div> <div> <x-input-label for="total_amount" value="Total TTC" /> <x-input id="total_amount" type="number" wire:model="total_amount" class="w-full bg-gray-50 font-bold text-lg" readonly /> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="expense_group_id" value="Groupe de dépenses" /> <x-select id="expense_group_id" wire:model="expense_group_id" class="w-full"> <option value="">Sélectionner un groupe</option> @foreach($expenseGroups as $group) <option value="{{ $group->id }}"> {{ $group->name }} @if($group->budget_allocated > 0) (Budget: {{ number_format($group->budget_remaining, 2) }} / {{ number_format($group->budget_allocated, 2) }} DZD) @endif </option> @endforeach </x-select> </div> <div> <x-input-label for="cost_center" value="Centre de coût" /> <x-input id="cost_center" wire:model="cost_center" placeholder="Ex: DEP-001, PROJ-2025" class="w-full" /> </div> </div> </div> </x-card> {{-- Fournisseur et paiement --}} <x-card> <div class="p-6 space-y-6"> <h3 class="text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2"> Fournisseur et paiement </h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="supplier_id" value="Fournisseur" /> <x-select id="supplier_id" wire:model="supplier_id" class="w-full"> <option value="">Sélectionner un fournisseur</option> @foreach($suppliers as $supplier) <option value="{{ $supplier->id }}">{{ $supplier->name }}</option> @endforeach </x-select> </div> <div> <x-input-label for="invoice_number" value="N° Facture" /> <x-input id="invoice_number" wire:model="invoice_number" class="w-full" /> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="reference_number" value="N° Référence" /> <x-input id="reference_number" wire:model="reference_number" class="w-full" /> </div> <div> <x-input-label for="external_reference" value="Référence externe" /> <x-input id="external_reference" wire:model="external_reference" placeholder="Ex: PO-12345, CMD-2025" class="w-full" /> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="payment_method" value="Méthode de paiement" /> <x-select id="payment_method" wire:model="payment_method" class="w-full"> @foreach(\App\Models\VehicleExpense::PAYMENT_METHODS as $key => $label) <option value="{{ $key }}">{{ $label }}</option> @endforeach </x-select> </div> <div> <x-input-label for="payment_status" value="Statut de paiement" /> <x-select id="payment_status" wire:model="payment_status" class="w-full"> <option value="unpaid">Non payé</option> <option value="paid">Payé</option> <option value="partial">Partiel</option> <option value="overdue">En retard</option> <option value="cancelled">Annulé</option> </x-select> </div> </div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"> <div> <x-input-label for="payment_date" value="Date de paiement" /> <x-input id="payment_date" type="date" wire:model="payment_date" class="w-full" /> </div> <div> <x-input-label for="due_date" value="Date d'échéance" /> <x-input id="due_date" type="date" wire:model="due_date" class="w-full" /> </div> </div> </div> </x-card> {{-- Documents et notes --}} <x-card> <div class="p-6 space-y-6"> <h3 class="text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2"> Documents et notes </h3> <div> <x-input-label for="attachments" value="Pièces jointes" /> <input id="attachments" type="file" wire:model="attachments" multiple accept=".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none" /> <p class="mt-1 text-sm text-gray-500">PDF, JPG, PNG, DOC, XLS (Max. 10MB par fichier)</p> @error('attachments.*') <span class="text-sm text-red-500">{{ $message }}</span> @enderror {{-- Affichage des pièces jointes existantes --}} @if($isEditMode && count($existingAttachments) > 0) <div class="mt-4 space-y-2"> <p class="text-sm font-medium text-gray-700">Fichiers existants:</p> @foreach($existingAttachments as $index => $attachment) <div class="flex items-center justify-between p-2 bg-gray-50 rounded"> <span class="text-sm text-gray-600"> {{ $attachment['name'] ?? 'Fichier' }} </span> <button type="button" wire:click="removeAttachment({{ $index }})" class="text-red-600 hover:text-red-700"> <x-iconify icon="solar:trash-bin-2-bold" class="w-4 h-4" /> </button> </div> @endforeach </div> @endif </div> <div> <x-input-label for="notes" value="Notes" /> <x-textarea id="notes" wire:model="notes" class="w-full" rows="4" placeholder="Ajouter des notes ou commentaires..." /> </div> </div> </x-card> {{-- Boutons d'action (répétés pour visibilité) --}} <div class="flex items-center justify-end gap-3"> <button type="button" wire:click="cancel" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition"> Annuler </button> <button type="submit" class="px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition"> <span wire:loading.remove> {{ $isEditMode ? 'Mettre à jour' : 'Créer la dépense' }} </span> <span wire:loading> <x-iconify icon="svg-spinners:3-dots-scale" class="w-5 h-5 inline" /> Enregistrement... </span> </button> </div> </form>
</div>